package jzcore

import chisel3._
import chisel3.util._

object RV64IM extends HasInstrType {
  def ADDI    = BitPat("b???????_?????_?????_000_?????_0010011")
  def EBREAK  = BitPat("b0000000_00001_00000_000_00000_1110011")
  def AUIPC   = BitPat("b???????_?????_?????_???_?????_0010111")
  def LUI     = BitPat("b???????_?????_?????_???_?????_0110111")
  def JAL     = BitPat("b???????_?????_?????_???_?????_1101111")
  def JALR    = BitPat("b???????_?????_?????_???_?????_1100111")
  def SD      = BitPat("b???????_?????_?????_011_?????_0100011")

  val table = Array (
    ADDI    -> List(InstrI, SrcType.reg, SrcType.imm, AluOp.add),
    EBREAK  -> List(InstrD, SrcType.nul, SrcType.nul, AluOp.nop),
    AUIPC   -> List(InstrU, SrcType.pc, SrcType.imm, AluOp.add),
    LUI     -> List(InstrU, SrcType.nul, SrcType.imm, AluOp.add),
    JAL     -> List(InstrJ, SrcType.pc, SrcType.plus4, AluOp.jump),
    JALR    -> List(InstrIJ, SrcType.pc, SrcType.plus4, AluOp.jump),
    SD      -> List(InstrS, SrcType.nul, SrcType.nul, AluOp.nop), //todo
  )
}

object Instruction extends HasInstrType {
  def NOP = 0x00000013.U
  val DecodeDefault = List(InstrN, AluOp.nop, SrcType.nul, SrcType.nul)
}